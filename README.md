# SimpleServer ä»»åŠ¡ç®¡ç†ç³»ç»ŸAPI

## ğŸ“š é‡è¦æ–‡æ¡£å‚è€ƒ
- [ğŸ“˜ APIæ¥å£æ–‡æ¡£](docs/API_DOCUMENTATION.md) - å®Œæ•´çš„APIæ¥å£è¯´æ˜ï¼Œä¾›å®¢æˆ·ç«¯å¼€å‘å‚è€ƒ
- [ğŸ“‹ é¡¹ç›®è§„èŒƒæ–‡æ¡£](docs/PROJECT_SPECIFICATION.md) - å®Œæ•´çš„å¼€å‘å’Œéƒ¨ç½²è§„èŒƒ
- [âš¡ å¿«é€Ÿå‚è€ƒå¡ç‰‡](docs/QUICK_REFERENCE.md) - å¸¸ç”¨å‘½ä»¤å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆ
- [ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜](PROJECT_STRUCTURE.md) - è¯¦ç»†çš„æ–‡ä»¶ç›®å½•ç»“æ„è¯´æ˜
- [ğŸ–¥ï¸ CentOSéƒ¨ç½²æŒ‡å—](DEPLOY_CENTOS_HOME.md) - æœåŠ¡å™¨éƒ¨ç½²è¯¦ç»†è¯´æ˜
- [ğŸ“¦ éƒ¨ç½²åŒ…è¯´æ˜](DEPLOY_PACKAGE_HOME.md) - éƒ¨ç½²åŒ…ä½¿ç”¨æŒ‡å—
- [ğŸ“‘ æ–‡æ¡£ä¸­å¿ƒ](docs/) - å®Œæ•´æ–‡æ¡£ç›®å½•

## é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªåŸºäºSpring Bootçš„RESTful APIæœåŠ¡ï¼Œç”¨äºä»»åŠ¡ç®¡ç†å’ŒåŒæ­¥åŠŸèƒ½ã€‚æ”¯æŒä¸MySQL 5.7æ•°æ®åº“çš„è¿æ¥ï¼Œæä¾›å®Œæ•´çš„CRUDæ“ä½œå’Œä»»åŠ¡åŒæ­¥åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ
- Java 8
- Spring Boot 2.7.0
- Spring Data JPA
- MySQL 5.7
- Maven 3.x
- Lombok

## é¡¹ç›®ç»“æ„
```

## ç‰ˆæœ¬å˜æ›´è®°å½•

### v1.2.0 - å®‰å…¨é…ç½®å¢å¼ºï¼ˆ2024å¹´ï¼‰
- âœ… å®ç°å¤šç¯å¢ƒé…ç½®ç®¡ç†ï¼Œåˆ†ç¦»æ•æ„Ÿä¿¡æ¯
- âœ… æ·»åŠ  `.gitignore` è§„åˆ™ä¿æŠ¤æ•æ„Ÿé…ç½®æ–‡ä»¶
- âœ… åˆ›å»ºæœ¬åœ°å¼€å‘é…ç½® `application-local.properties`
- âœ… åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®æ¨¡æ¿ `application-prod.properties`
- âœ… æ”¯æŒç¯å¢ƒå˜é‡é…ç½®ï¼ˆ`.env` æ–‡ä»¶ï¼‰
- âœ… æ›´æ–°ä¸»é…ç½®æ–‡ä»¶ä½¿ç”¨å ä½ç¬¦
- âœ… æ·»åŠ å®‰å…¨é…ç½®æ£€æŸ¥è„šæœ¬ `setup-security.bat`
- âœ… æ›´æ–°è¿è¡Œè„šæœ¬æ”¯æŒprofileé…ç½®
- âœ… æ·»åŠ å®‰å…¨é…ç½®æ–‡æ¡£å’Œæ£€æŸ¥æ¸…å•
- âœ… ç›¸å…³æ–‡ä»¶å˜æ›´ï¼š
  - `application.properties`: æ”¹ä¸ºå ä½ç¬¦é…ç½®
  - `.gitignore`: æ·»åŠ æ•æ„Ÿæ–‡ä»¶æ’é™¤è§„åˆ™
  - æ–°å¢å¤šä¸ªé…ç½®æ¨¡æ¿æ–‡ä»¶å’Œæ–‡æ¡£

### v1.1.0 - è½¯åˆ é™¤åŠŸèƒ½ï¼ˆ2024å¹´ï¼‰
- âœ… å®ç°è½¯åˆ é™¤æœºåˆ¶ï¼Œåœ¨ tasks è¡¨ä¸­æ·»åŠ  is_delete å­—æ®µ
- âœ… ä¿®æ”¹åˆ é™¤æ¥å£ä¸ºé€»è¾‘åˆ é™¤ï¼Œæ•°æ®ä¸ä¼šçœŸæ­£ä»æ•°æ®åº“ç§»é™¤
- âœ… æ·»åŠ ä»»åŠ¡æ¢å¤æ¥å£ `/api/tasks/{id}/restore`
- âœ… æ›´æ–°æ‰€æœ‰æŸ¥è¯¢æ¥å£ï¼Œè‡ªåŠ¨è¿‡æ»¤å·²åˆ é™¤çš„ä»»åŠ¡
- âœ… æä¾›æ•°æ®åº“å­—æ®µæ›´æ–°è„šæœ¬ `src/main/resources/db/add_is_delete_column.sql`
- âœ… ç›¸å…³æ–‡ä»¶å˜æ›´ï¼š
  - `Task.java`: æ·»åŠ  isDelete å­—æ®µå’Œç›¸å…³æ–¹æ³•
  - `TaskRepository.java`: æ·»åŠ è½¯åˆ é™¤æŸ¥è¯¢æ–¹æ³•
  - `TaskService.java`: å®ç°è½¯åˆ é™¤å’Œæ¢å¤é€»è¾‘
  - `TaskController.java`: æ·»åŠ ä»»åŠ¡æ¢å¤æ¥å£

### v1.0.0 - åˆå§‹ç‰ˆæœ¬
- âœ… åŸºç¡€çš„CRUDæ“ä½œ
- âœ… ä»»åŠ¡åŒæ­¥åŠŸèƒ½
- âœ… MySQLæ•°æ®åº“é›†æˆ
- âœ… RESTful APIè®¾è®¡
simpleServer/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ com/example/simpleserver/
â”‚       â”‚       â”œâ”€â”€ controller/     # æ§åˆ¶å™¨å±‚
â”‚       â”‚       â”œâ”€â”€ service/        # ä¸šåŠ¡é€»è¾‘å±‚
â”‚       â”‚       â”œâ”€â”€ repository/     # æ•°æ®è®¿é—®å±‚
â”‚       â”‚       â”œâ”€â”€ model/          # å®ä½“æ¨¡å‹å±‚
â”‚       â”‚       â”œâ”€â”€ config/         # é…ç½®ç±»
â”‚       â”‚       â””â”€â”€ SimpleServerApplication.java  # å¯åŠ¨ç±»
â”‚       â””â”€â”€ resources/      # èµ„æºæ–‡ä»¶
â”‚           â”œâ”€â”€ application.properties  # åº”ç”¨é…ç½®
â”‚           â””â”€â”€ db/         # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ target/                 # Mavenæ„å»ºè¾“å‡ºç›®å½•
â”œâ”€â”€ deploy/                 # éƒ¨ç½²æ–‡ä»¶ç›®å½•
â”œâ”€â”€ docs/                   # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ scripts/                # è„šæœ¬å·¥å…·ç›®å½•
â”œâ”€â”€ test/                   # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”œâ”€â”€ apache-maven-3.8.6/     # æœ¬åœ°Mavenå®‰è£…ç›®å½•
â”œâ”€â”€ pom.xml                 # Mavené¡¹ç›®é…ç½®æ–‡ä»¶
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```
## æ•°æ®åº“é…ç½®

### 1. åˆ›å»ºæ•°æ®åº“
è¿è¡Œ `src/main/resources/db/init.sql` è„šæœ¬æ¥åˆ›å»ºæ•°æ®åº“å’Œè¡¨ç»“æ„ã€‚

### 2. é…ç½®æ•°æ®åº“è¿æ¥
ä¿®æ”¹ `src/main/resources/application.properties` æ–‡ä»¶ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š

```
properties
spring.datasource.url=jdbc:mysql://localhost:3306/simpleserver?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.username=your_username
spring.datasource.password=your_password
```
## APIæ¥å£è¯´æ˜

### 1. åŒæ­¥ä»»åŠ¡
**POST** `/api/tasks/sync`
- åŠŸèƒ½ï¼šæ‰¹é‡åŒæ­¥ä»»åŠ¡
- è¯·æ±‚ä½“ï¼šä»»åŠ¡å¯¹è±¡æ•°ç»„
- å“åº”ï¼šSyncResponseå¯¹è±¡

### 2. è·å–æ‰€æœ‰ä»»åŠ¡
**GET** `/api/tasks`
- åŠŸèƒ½ï¼šè·å–æ‰€æœ‰ä»»åŠ¡ï¼ŒæŒ‰æ›´æ–°æ—¶é—´å€’åºæ’åˆ—
- å“åº”ï¼šä»»åŠ¡å¯¹è±¡æ•°ç»„

### 3. è·å–å•ä¸ªä»»åŠ¡
**GET** `/api/tasks/{id}`
- åŠŸèƒ½ï¼šæ ¹æ®IDè·å–ç‰¹å®šä»»åŠ¡
- å“åº”ï¼šä»»åŠ¡å¯¹è±¡

### 4. åˆ›å»ºä»»åŠ¡
**POST** `/api/tasks`
- åŠŸèƒ½ï¼šåˆ›å»ºæ–°ä»»åŠ¡
- è¯·æ±‚ä½“ï¼šä»»åŠ¡å¯¹è±¡
- å“åº”ï¼šåˆ›å»ºçš„ä»»åŠ¡å¯¹è±¡

### 5. æ›´æ–°ä»»åŠ¡
**PUT** `/api/tasks/{id}`
- åŠŸèƒ½ï¼šæ›´æ–°æŒ‡å®šIDçš„ä»»åŠ¡
- è¯·æ±‚ä½“ï¼šä»»åŠ¡å¯¹è±¡
- å“åº”ï¼šæ›´æ–°åçš„ä»»åŠ¡å¯¹è±¡

### 6. åˆ é™¤ä»»åŠ¡ï¼ˆè½¯åˆ é™¤ï¼‰
**DELETE** `/api/tasks/{id}`
- åŠŸèƒ½ï¼šé€»è¾‘åˆ é™¤æŒ‡å®šIDçš„ä»»åŠ¡ï¼ˆæ ‡è®°ä¸ºå·²åˆ é™¤ï¼‰
- å“åº”ï¼š204 No Content

### 7. æ¢å¤ä»»åŠ¡
**PUT** `/api/tasks/{id}/restore`
- åŠŸèƒ½ï¼šæ¢å¤å·²åˆ é™¤çš„ä»»åŠ¡
- å“åº”ï¼šæˆåŠŸæ¶ˆæ¯æˆ–404 Not Found

## ä»»åŠ¡å¯¹è±¡ç»“æ„
```
json
{
    "id": 1,
    "name": "ä»»åŠ¡åç§°",
    "timeInMillis": 1640995200000,
    "isMonthly": false,
    "remindCount": 0,
    "isDone": false,
    "remarks": "å¤‡æ³¨ä¿¡æ¯",
    "imagePaths": "[\"path1\", \"path2\"]",
    "maxRetries": 3,
    "retryIntervalHours": 1,
    "repeatMode": 0,
    "createdAt": "2022-01-01 00:00:00",
    "updatedAt": "2022-01-01 00:00:00"
}
```
## åŒæ­¥å“åº”ç»“æ„
```
json
{
    "success": true,
    "message": "ä»»åŠ¡åŒæ­¥æˆåŠŸ",
    "count": 5
}
```
## è¿è¡Œé¡¹ç›®

### æ–¹æ³•1ï¼šä½¿ç”¨Maven
```
bash
mvn spring-boot:run
```
### æ–¹æ³•2ï¼šä½¿ç”¨IDE
ç›´æ¥è¿è¡Œ `SimpleServerApplication.java` çš„mainæ–¹æ³•

### æ–¹æ³•3ï¼šæ‰“åŒ…è¿è¡Œ
```
bash
mvn clean package
java -jar target/simpleServer-1.0.0.jar
```
## æµ‹è¯•API

é¡¹ç›®å¯åŠ¨åï¼Œé»˜è®¤ç«¯å£ä¸º37210ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œæµ‹è¯•ï¼š

### ä½¿ç”¨curlæµ‹è¯•
```
bash
# è·å–æ‰€æœ‰ä»»åŠ¡
curl http://localhost:37210/api/tasks

# åˆ›å»ºæ–°ä»»åŠ¡
curl -X POST http://localhost:37210/api/tasks \
  -H "Content-Type: application/json" \
  -d '{"name":"æµ‹è¯•ä»»åŠ¡","timeInMillis":1640995200000,"isDone":false}'

# åŒæ­¥ä»»åŠ¡
curl -X POST http://localhost:37210/api/tasks/sync \
  -H "Content-Type: application/json" \
  -d '[{"name":"ä»»åŠ¡1","timeInMillis":1640995200000},{"name":"ä»»åŠ¡2","timeInMillis":1640995200000}]'
```
### ä½¿ç”¨Postmanæµ‹è¯•
å¯¼å…¥ä»¥ä¸‹é›†åˆè¿›è¡ŒAPIæµ‹è¯•ï¼š
- GET http://localhost:37210/api/tasks
- POST http://localhost:37210/api/tasks
- POST http://localhost:37210/api/tasks/sync

## æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“å‡†å¤‡**ï¼šç¡®ä¿MySQLæœåŠ¡å·²å¯åŠ¨ï¼Œå¹¶ä¸”æ•°æ®åº“ç”¨æˆ·å…·æœ‰ç›¸åº”æƒé™
2. **æ—¶é—´æˆ³å¤„ç†**ï¼šä½¿ç”¨æ¯«ç§’çº§æ—¶é—´æˆ³ï¼ˆtimeInMillisï¼‰ï¼Œç¡®ä¿è·¨è®¾å¤‡ä¸€è‡´æ€§
3. **JSONæ•°ç»„å¤„ç†**ï¼šimagePathså­—æ®µå­˜å‚¨ä¸ºJSONå­—ç¬¦ä¸²
4. **åºŸå¼ƒå­—æ®µ**ï¼šisMonthlyå­—æ®µå·²åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨repeatModeå­—æ®µ
5. **è½¯åˆ é™¤æœºåˆ¶**ï¼šåˆ é™¤æ“ä½œä¸ºé€»è¾‘åˆ é™¤ï¼Œä¸ä¼šçœŸæ­£ä»æ•°æ®åº“ç§»é™¤æ•°æ®
6. **é”™è¯¯å¤„ç†**ï¼š
   - 400é”™è¯¯ï¼šå®¢æˆ·ç«¯è¯·æ±‚æ ¼å¼é”™è¯¯
   - 500é”™è¯¯ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## å¼€å‘ç¯å¢ƒè¦æ±‚
- Java 8 æˆ–æ›´é«˜ç‰ˆæœ¬
- MySQL 5.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- Maven 3.x æˆ–ä½¿ç”¨IDEå†…ç½®Maven

## éƒ¨ç½²è¯´æ˜
1. ä¿®æ”¹ç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“é…ç½®
2. å¦‚æœæ˜¯ä»æ—§ç‰ˆæœ¬å‡çº§ï¼Œè¯·å…ˆæ‰§è¡Œè½¯åˆ é™¤å­—æ®µæ·»åŠ è„šæœ¬ï¼š`src/main/resources/db/add_is_delete_column.sql`
3. æ‰“åŒ…åº”ç”¨ï¼š`mvn clean package`
4. è¿è¡ŒjaråŒ…ï¼š`java -jar simpleServer-1.0.0.jar`
5. å¯é€šè¿‡ `-Dserver.port=ç«¯å£å·` æŒ‡å®šç«¯å£

## è„šæœ¬å·¥å…·ä½¿ç”¨

### æœ¬åœ°å¼€å‘
```
cmd
# å¿«é€Ÿå¯åŠ¨
scripts\run.bat

# é¡¹ç›®æ„å»ºï¼ˆä»…ç¼–è¯‘ï¼Œä¸æ‰“åŒ…ï¼‰
scrips\build.bat

# æ„å»ºå¹¶ç”Ÿæˆå®Œæ•´éƒ¨ç½²åŒ…ï¼ˆæ¨èç”¨äºå‘å¸ƒï¼‰
scripts\build-and-package.bat
```
### æœåŠ¡å™¨éƒ¨ç½²
```
bash
# ä¸Šä¼ deployç›®å½•åˆ°æœåŠ¡å™¨åæ‰§è¡Œ
chmod +x start-simpleServer.sh health-check.sh
./start-simpleServer.sh start
```
